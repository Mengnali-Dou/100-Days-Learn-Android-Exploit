# Day3--Menu

- 在 /res 中新建文件夹 menu

	<img src="C:\Users\10047\AppData\Roaming\Typora\typora-user-images\image-20220418085221595.png" alt="image-20220418085221595" style="zoom:80%;" />

- /res/menu 中添加 menu 文件

	<img src="C:\Users\10047\AppData\Roaming\Typora\typora-user-images\image-20220418085512792.png" alt="image-20220418085512792" style="zoom:80%;" />

- qqmenu.xml

	```xml
	<?xml version="1.0" encoding="utf-8"?>
	<menu xmlns:android="http://schemas.android.com/apk/res/android">
	    <item
	        android:id="@+id/m_createchat"
	        android:icon="@mipmap/createchat"
	        android:title="创建群聊">
	        <menu>
	            <item
	                android:id="@+id/m_inventor"
	                android:title="邀请入群" />
	            <item
	                android:id="@+id/m_scanadd"
	                android:title="扫码入群" />
	        </menu>
	
	    </item>
	    <item
	        android:id="@+id/m_addfriend"
	        android:icon="@mipmap/addfriend"
	        android:title="加好友/群" />
	    <item
	        android:id="@+id/m_party"
	        android:icon="@mipmap/party"
	        android:title="一起派对" />
	    <item
	        android:id="@+id/m_scan"
	        android:icon="@mipmap/scan"
	        android:title="扫一扫" />
	    <item
	        android:id="@+id/m_facetoface"
	        android:icon="@mipmap/facetoface"
	        android:title="面对面快传" />
	    <item
	        android:id="@+id/m_pay"
	        android:icon="@mipmap/pay"
	        android:title="收付款" />
	
	</menu>
	```

	

- activity_main.xml

	```xml
	<?xml version="1.0" encoding="utf-8"?>
	<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
	    xmlns:app="http://schemas.android.com/apk/res-auto"
	    xmlns:tools="http://schemas.android.com/tools"
	    android:layout_width="match_parent"
	    android:layout_height="match_parent"
	    tools:context=".MainActivity">
	
	    <TextView
	        android:layout_width="wrap_content"
	        android:layout_height="wrap_content"
	        android:id="@+id/tv_message"/>
	
	</LinearLayout>
	```

	

- MainActivity.java

	```java
	package com.example.day3__menu;
	
	import androidx.annotation.NonNull;
	import androidx.appcompat.app.AppCompatActivity;
	
	import android.os.Bundle;
	import android.view.Menu;
	import android.view.MenuItem;
	import android.widget.TextView;
	import android.widget.Toast;
	
	import java.lang.reflect.InvocationTargetException;
	import java.lang.reflect.Method;
	
	public class MainActivity extends AppCompatActivity {
	
	    TextView tv_message;
	
	    @Override
	    protected void onCreate(Bundle savedInstanceState) {
	        super.onCreate(savedInstanceState);
	        setContentView(R.layout.activity_main);
	    }
	
	    @Override
	    public boolean onCreateOptionsMenu(Menu menu) {
	        getMenuInflater().inflate(R.menu.qqmenu,menu);    // 实例化Menu目录下的Menu布局文件
	        return super.onCreateOptionsMenu(menu);
	    }
	
	    // 采用反射的方式显示选项菜单的图标
	    @Override
	    public boolean onMenuOpened(int featureId, Menu menu) {
	        if (menu != null) {
	            try {
	                Method method = menu.getClass().getDeclaredMethod("setOptionalIconsVisible", Boolean.TYPE);
	                method.setAccessible(true);
	                method.invoke(menu, true);
	            } catch (Exception e) {
	                e.printStackTrace();
	            }
	        }
	        return super.onMenuOpened(featureId, menu);
	    }
	
	    @Override
	    public boolean onOptionsItemSelected(@NonNull MenuItem item) {
	        switch (item.getItemId()) {
	            case R.id.m_createchat:
	                Toast.makeText(this, "创建群聊", Toast.LENGTH_SHORT).show();
	                break;
	            case R.id.m_inventor:
	                Toast.makeText(this, "扫码入群", Toast.LENGTH_SHORT).show();
	                break;
	            case R.id.m_scanadd:
	                Toast.makeText(this, "创建群聊", Toast.LENGTH_SHORT).show();
	                break;
	            case R.id.m_addfriend:
	                Toast.makeText(this, "加好友/群", Toast.LENGTH_SHORT).show();
	                break;
	            case R.id.m_party:
	                Toast.makeText(this, "一起派对", Toast.LENGTH_SHORT).show();
	                break;
	            case R.id.m_scan:
	                Toast.makeText(this, "扫一扫", Toast.LENGTH_SHORT).show();
	                break;
	            case R.id.m_facetoface:
	                Toast.makeText(this, "面对面快传", Toast.LENGTH_SHORT).show();
	                break;
	            case R.id.m_pay:
	                Toast.makeText(this, "收付款", Toast.LENGTH_SHORT).show();
	                break;
	        }
	        return super.onOptionsItemSelected(item);
	    }
	
	}
	```

	